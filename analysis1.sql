SELECT regexp_replace(a.segment_name, '[^\\x20-\\x7A]+', '') as Segment, a.segment_id as SegId, regexp_replace(b.entries[0].athlete_name, '[^\\x20-\\x7A]+', '') as KOM, b.entries[0].elapsed_time as TimeK, a.elapsed_time as You, (a.elapsed_time - b.entries[0].elapsed_time) as Diff, round(100*(((a.elapsed_time - b.entries[0].elapsed_time)/b.entries[0].elapsed_time)),2) as Pcnt, regexp_replace(b.entries[9].athlete_name, '[^\\x20-\\x7A]+', '') as Tenth, b.entries[9].elapsed_time as Time10, (a.elapsed_time - b.entries[9].elapsed_time) as Diff10, round(100*(((a.elapsed_time - b.entries[9].elapsed_time)/b.entries[9].elapsed_time)),2) as Pcnt10 FROM besteffortforsegments a JOIN leaderboardforsegment b on a.segment_id = b.segment_id WHERE b.entries[0].elapsed_time < a.elapsed_time ORDER BY Pcnt;
