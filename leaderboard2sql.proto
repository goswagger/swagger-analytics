select CONCAT('curl -D hdr.out -X GET https://www.strava.com/api/v3/segments/',min(segName.segment.id),'/leaderboard -d access_token=ACCESS_TOKEN -d context_entries=10') seg from segmentsforactivity lateral view explode(segment_efforts) segTable as segName WHERE segName.segment.id NOT IN (SELECT segment_id from leaderboardforsegment) GROUP BY segName.name ORDER BY seg;
